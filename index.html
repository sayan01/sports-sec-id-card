<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Description -->
  <meta name="description" content="">
  <meta property="og:description" content="">
  <meta name="twitter:description" content="">

  <!-- Author -->
  <meta name="author" content="Sayan">
  <meta name="twitter:site" content="@_sayang2001">
  <meta name="twitter:creator" content="@_sayang2001">

  <!-- Title -->
  <title></title>
  <meta property="og:title" content="">
  <meta name="twitter:title" content="">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png">
  <meta property="og:image" content="favicon.png">
  <meta name="twitter:image" content="favicon.png">

  <!-- Bootstrap CSS and JS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
	
  <!-- Font Awesome 5 -->
  <script defer src="https://kit.fontawesome.com/3713245705.js" crossorigin="anonymous"></script>

</head>
<body style="text-align: center;">
  <h1 class="display-1">Download your Sports SEC ID Card</h1>
  <label for="roll">Enter your roll number:</label>
  <input type="text" name="roll" id="roll" placeholder="example 22BCAA01">
  <input type="submit" value="Download" class="btn btn-primary" onclick="download()">
  <div id="download" class="mt-5"></div>
  <script>
    // Get the input field
    var input = document.getElementById("roll");

    // Execute a function when the user presses a key on the keyboard
    input.addEventListener("keypress", function(event) {
      // If the user presses the "Enter" key on the keyboard
      if (event.key === "Enter") {
        // Cancel the default action, if needed
        event.preventDefault();
        // Trigger the button element with a click
        download();
      }
    });

    function download(){
      fetch("participants/list")
        .then((response) => response.text(response))
        .then((data) => {
          var rollno = document.querySelector('#roll').value.toUpperCase();
          if(data.includes(rollno)){
            document.body.innerHTML += 
            `<a href="participants/id/${rollno}.png" id="downlink" download="${rollno}-Sports-SEC-ID-card">Download ID card!</a>`
            linkdown = document.querySelector('#downlink');
            linkdown.click();
            document.body.removeChild(linkdown);
          } else {
            alert('ID card does not exist for this roll number! Enter correct roll number');
          }
        });
    }
  </script>
</body>
</html>
